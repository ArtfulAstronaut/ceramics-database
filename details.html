<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mold Details</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
    <header>
        <h1>Mold Details</h1>
    </header>
    
    <main>
        <div id="moldDetails"></div>
    </main>

    <footer>
        <p>Made with ❤️ from the Earth</p>
    </footer>

    <script>
        const sheetID = '1brx43eDqhroWHrSNgjPII1IQ667ofr0nZ3APFTtYhXc'; // Replace with your actual sheet ID
        const apiKey = 'AIzaSyDm8pwzgmPsxdhrt7KTa4FHwXMBdlcFn5k'; // Replace with your actual API key
        const base = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/Sheet1?key=${apiKey}`;

        async function fetchData() {
            try {
                const res = await fetch(base);
                if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
                const json = await res.json();
                const data = json.values.slice(1).map(row => {
                    return {
                        name: row[0] ?? '',
                        number: row[1] ?? '',
                        manufacturer: row[2] ?? '',
                        bisquePrice: row[3] ?? '',
                        partOfASet: row[4] ?? '',
                        shelfWall: row[5] ?? '',
                        shelfNumber: row[6] ?? '',
                        shelfLevel: row[7] ?? '',
                        keywords: row[8] ?? '',
                        notes: row[9] ?? '',
                        image: row[10] ?? 'https://via.placeholder.com/300' // Fallback image
                    };
                });
                return data;
            } catch (error) {
                console.error('Error fetching data:', error);
                return [];
            }
        }

        async function initializeDetailsPage() {
            const params = new URLSearchParams(window.location.search);
            const moldName = params.get('name'); // Get the mold name from the query parameter

            if (!moldName) {
                document.getElementById('moldDetails').innerHTML = '<p>Error: No mold name provided in the URL.</p>';
                return;
            }

            const data = await fetchData();
            const mold = data.find(m => m.name.toLowerCase() === moldName.toLowerCase());

            if (!mold) {
                document.getElementById('moldDetails').innerHTML = '<p>Error: Mold not found in the database.</p>';
                return;
            }

            // Combine shelfWall, shelfNumber, and shelfLevel into one line
            const shelfLocation = `${mold.shelfWall || 'N/A'} - ${mold.shelfNumber || 'N/A'} - ${mold.shelfLevel || 'N/A'}`;

            const moldDetails = document.getElementById('moldDetails');
            moldDetails.innerHTML = `
                <img src="${mold.image}" alt="${mold.name}" style="width: 100%; max-height: 300px; object-fit: cover;">
                <h2>${mold.name}</h2>
                <p><strong>Number:</strong> ${mold.number}</p>
                <p><strong>Manufacturer:</strong> ${mold.manufacturer}</p>
                <p><strong>Bisque Price:</strong> ${mold.bisquePrice}</p>
                <p><strong>Part of a Set:</strong> ${mold.partOfASet}</p>
                <p><strong>Shelf Location:</strong> ${shelfLocation}</p>
                <p><strong>Keywords:</strong> ${mold.keywords}</p>
                <p><strong>Notes:</strong> ${mold.notes}</p>
            `;
        }

        initializeDetailsPage();
    </script>
</body>
</html>
